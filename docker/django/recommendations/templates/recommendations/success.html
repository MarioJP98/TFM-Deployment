<h1>Recomendación enviada</h1>

<p>Buscando canciones similares a:</p>
<ul>
  <li><strong>Título:</strong> {{ features.track_name }}</li>
  <li><strong>Artista:</strong> {{ features.artist_name }}</li>
  <li><strong>Tempo:</strong> {{ features.tempo }}</li>
  <li><strong>Loudness:</strong> {{ features.loudness }}</li>
  <li><strong>Clave:</strong> {{ features.key }}</li>
  <li><strong>Modo:</strong> {{ features.mode }}</li>
  <li><strong>Compás:</strong> {{ features.time_signature }}/4</li>
</ul>

<hr>

<div id="results">
  <p>Esperando recomendaciones...</p>
</div>

<script>
  const recommendationId = "{{ recommendation_id }}";
  const resultsDiv = document.getElementById("results");

  async function fetchResults() {
    const response = await fetch(`/results/${recommendationId}/`);
    const data = await response.json();

    if (data.recommendations.length > 0) {
      resultsDiv.innerHTML = "<h3>Recomendaciones similares:</h3><ul>" +
        data.recommendations.map(r => `<li>${r.artist} - ${r.title}</li>`).join('') +
        "</ul>";
    } else {
      setTimeout(fetchResults, 3000);  // Reintenta si aún no hay datos
    }
  }

  fetchResults();
</script>
